{"version":3,"mappings":"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","names":["routes","path","component","_book_search_page__WEBPACK_IMPORTED_MODULE_0__","BookSearchPageRoutingModule","imports","_angular_router__WEBPACK_IMPORTED_MODULE_3__","exports","BookSearchPageModule","_angular_common__WEBPACK_IMPORTED_MODULE_5__","_angular_forms__WEBPACK_IMPORTED_MODULE_6__","_ionic_angular__WEBPACK_IMPORTED_MODULE_7__","_book_search_routing_module__WEBPACK_IMPORTED_MODULE_0__","declarations","_book_search_page__WEBPACK_IMPORTED_MODULE_1__","_pipes_filter_pipe__WEBPACK_IMPORTED_MODULE_2__","BookSearchPage","afs","afAuth","angularFirestore","user","JSON","parse","localStorage","getItem","collection","snapshotChanges","pipe","booksShelves","map","t","Object","id","payload","doc","data","filter","userId","uid","subscribe","books","unfilteredBooks","x","includes","bookShelfId","_services_firestore_service__WEBPACK_IMPORTED_MODULE_2__","_angular_fire_auth__WEBPACK_IMPORTED_MODULE_4__","_angular_fire_firestore__WEBPACK_IMPORTED_MODULE_5__","selector","template","FirestoreService","afStore","onAuthStateChanged","currentUser","book","add","authors","cover","isbn","number_of_pages","publish_date","publishers","title","createdAt","_angular_fire_auth__WEBPACK_IMPORTED_MODULE_0__","_angular_fire_firestore__WEBPACK_IMPORTED_MODULE_1__","providedIn","__webpack_exports__"],"sources":["webpack:///src/app/pages/book-search/book-search-routing.module.ts","webpack:///src/app/pages/book-search/book-search.module.ts","webpack:///src/app/pages/book-search/book-search.page.ts","webpack:///src/app/services/firestore.service.ts","webpack:///src/app/pages/book-search/book-search.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { BookSearchPage } from './book-search.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: BookSearchPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class BookSearchPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { BookSearchPageRoutingModule } from './book-search-routing.module';\n\nimport { BookSearchPage } from './book-search.page';\nimport { FilterPipe } from '../../pipes/filter.pipe';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    BookSearchPageRoutingModule\n  ],\n  declarations: [BookSearchPage, FilterPipe]\n})\nexport class BookSearchPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { mergeMap } from 'rxjs/operators';\nimport { Book, Bookshelf, FirestoreService } from '../../services/firestore.service';\nimport { User } from '../../shared/auth';\n\n@Component({\n  selector: 'app-book-search',\n  templateUrl: './book-search.page.html',\n  styleUrls: ['./book-search.page.scss']\n})\nexport class BookSearchPage implements OnInit {\n  public booksShelves: Bookshelf[];\n  public books: Book[];\n  public searchTerm: string;\n\n  constructor(\n    public afs: FirestoreService,\n    public afAuth: AngularFireAuth,\n    private angularFirestore: AngularFirestore\n  ) {\n  }\n\n  public ngOnInit(): void {\n  }\n\n  ionViewWillEnter() {\n    const user = JSON.parse(localStorage.getItem('user')) as User;\n\n    if(user) {\n      this.angularFirestore.collection('bookshelfs').snapshotChanges().pipe(\n        mergeMap((booksShelves) => {\n          this.booksShelves = booksShelves\n            .map((t) => ({\n              id: t.payload.doc.id,\n              ...t.payload.doc.data() as Bookshelf\n            }))\n            .filter(t => t.userId === user.uid);\n\n          return this.angularFirestore.collection('books').snapshotChanges();\n        })\n      ).subscribe((books) => {\n        const unfilteredBooks = books\n          .map((t) => ({\n            id: t.payload.doc.id,\n            ...t.payload.doc.data() as Book\n          }));\n        this.books = unfilteredBooks.filter(t => this.booksShelves.map(x => x.id).includes(t.bookShelfId));\n      });\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport {\n  AngularFirestore,\n  AngularFirestoreDocument,\n  AngularFirestoreCollection,\n} from '@angular/fire/firestore';\nimport firebase from 'firebase/app';\n\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nexport interface Users {\n  uid: string;\n  displayName: string;\n}\n\nexport interface Bookshelf {\n  id: string;\n  userId: string;\n  name: string;\n}\n\nexport interface Book {\n  id?: string;\n  authors?: string;\n  cover?: string;\n  isbn?: string;\n  number_of_pages?: string;\n  publish_date?: string;\n  publishers?: string;\n  title?: string;\n  bookShelfId: string;\n  createdAt: Date;\n}\n\nexport interface Stars {\n  booksID: string;\n  userID: string;\n  text: string;\n  rating: number;\n  createdAt: firebase.firestore.FieldValue;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FirestoreService {\n  currentUser: Users = null;\n  currentReview: Stars = null;\n  usersCollection: AngularFirestoreCollection<Users>;\n  users: Observable<Users[]>;\n\n  constructor(\n    public afAuth: AngularFireAuth,\n    public afStore: AngularFirestore\n  ) {\n    this.afAuth.onAuthStateChanged((user) => {\n      this.currentUser = user;\n    });\n  }\n\n  // getBooks() {\n  //   this.afStore\n  //     .collection('books')\n  //     .get()\n  //     .forEach((el) => {\n  //       console.log(el);\n  //     });\n  // }\n\n  // Asta functioneaza, daca tu ai alta modalitate, poti sa o modifici schimbi\n  addBook(book: Book) {\n    return this.afStore.collection('books').add({\n      authors: book.authors,\n      cover: book.cover,\n      isbn: book.isbn,\n      number_of_pages: book.number_of_pages,\n      publish_date: book.publish_date,\n      publishers: book.publishers,\n      title: book.title,\n      bookShelfId: book.bookShelfId,\n      createdAt: book.createdAt\n    });\n  }\n}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title class=\\\"title-text\\\">Search library</ion-title>\\n  </ion-toolbar>\\n  <ion-grid fixed>\\n    <ion-row>\\n      <ion-col\\n        size=\\\"12\\\"\\n        class=\\\"ion-align-items-center ion-justify-content-center\\\"\\n      >\\n        <ion-searchbar\\n          showCancelButton=\\\"never\\\"\\n          placeholder=\\\"Filter by Book Title\\\"\\n          [(ngModel)]=\\\"searchTerm\\\"\\n          animated\\n        ></ion-searchbar>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-header>\\n<ion-content>\\n  <ion-grid class=\\\"ion-align-items-center ion-justify-content-center\\\">\\n    <ion-row class=\\\"ion-justify-content-center\\\">\\n      <!-- tot ce e in ion-col e template-ul pentru afisarea cartilor -->\\n      <ion-col\\n        size=\\\"12\\\"\\n        size-md=\\\"6\\\"\\n        size-lg=\\\"4\\\"\\n        style=\\\"width: 390px\\\"\\n        *ngFor=\\\"let book of books| filter:searchTerm\\\"\\n      >\\n        <ion-card>\\n          <ion-card-header>\\n            <ion-item lines=\\\"none\\\">\\n              <ion-label class=\\\"card-title ion-text-wrap\\\"\\n                >{{book.title}}</ion-label\\n              >\\n            </ion-item>\\n          </ion-card-header>\\n          <ion-card-content\\n            class=\\\"\\n              ion-text-center\\n              ion-justify-content-between\\n              ion-align-center-center\\n            \\\"\\n          >\\n            <div\\n              style=\\\"width: 100px; height: 250px\\\"\\n              class=\\\"ion-float-left ion-align-items-center\\\"\\n            >\\n              <ion-img\\n                class=\\\"ion-float-left ion-align-self-center\\\"\\n                src=\\\"{{book.cover}}\\\"\\n                style=\\\"width: 100px; height: 250px; margin-top: 10%\\\"\\n              ></ion-img>\\n            </div>\\n            <ion-list lines=\\\"none\\\">\\n              <ion-item>\\n                <ion-label>Authors: <span>{{book.authors}}</span></ion-label>\\n              </ion-item>\\n              <ion-item>\\n                <ion-label\\n                  >Publisher: <span>{{book.publishers}}</span></ion-label\\n                >\\n              </ion-item>\\n              <ion-item>\\n                <ion-label\\n                  >Publish date: <span>{{book.publish_date}}</span></ion-label\\n                >\\n              </ion-item>\\n              <ion-item>\\n                <ion-label\\n                  >Number of pages:\\n                  <span>{{book.number_of_pages}}</span></ion-label\\n                >\\n              </ion-item>\\n              <ion-item>\\n                <ion-label>ISBN: <span>{{book.isbn}}</span></ion-label>\\n              </ion-item>\\n            </ion-list>\\n          </ion-card-content>\\n        </ion-card>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\\n\";"]}