{"version":3,"file":"src_app_pages_review-search_review-search_module_ts-es2015.js","mappings":"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","sources":["./src/app/pages/review-search/review-search-routing.module.ts","./src/app/pages/review-search/review-search.module.ts","./src/app/pages/review-search/review-search.page.ts","./src/app/services/firestore.service.ts","./src/app/pages/review-search/review-search.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ReviewSearchPage } from './review-search.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ReviewSearchPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ReviewSearchPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\nimport { FilterPipe } from '../../pipes/filter.pipe';\n\nimport { ReviewSearchPageRoutingModule } from './review-search-routing.module';\n\nimport { ReviewSearchPage } from './review-search.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReviewSearchPageRoutingModule\n  ],\n  declarations: [ReviewSearchPage, FilterPipe]\n})\nexport class ReviewSearchPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { mergeMap } from 'rxjs/operators';\nimport { Book, Bookshelf, FirestoreService } from '../../services/firestore.service';\nimport { User } from '../../shared/auth';\nimport { Review } from '../review/review.page';\n\n@Component({\n  selector: 'app-review-search',\n  templateUrl: './review-search.page.html',\n  styleUrls: ['./review-search.page.scss']\n})\nexport class ReviewSearchPage implements OnInit {\n  public booksShelves: Bookshelf[];\n  public books: Book[];\n  public reviews: Review[];\n  public searchTerm: string;\n\n  constructor(\n    public afs: FirestoreService,\n    public afAuth: AngularFireAuth,\n    private angularFirestore: AngularFirestore\n  ) {\n  }\n\n  public ngOnInit(): void {\n  }\n\n  ionViewWillEnter() {\n    const user = JSON.parse(localStorage.getItem('user')) as User;\n\n    if(user) {\n      this.angularFirestore.collection('bookshelfs').snapshotChanges().pipe(\n        mergeMap((booksShelves) => {\n          this.booksShelves = booksShelves\n            .map((t) => ({\n              id: t.payload.doc.id,\n              ...t.payload.doc.data() as Bookshelf\n            }))\n            .filter(t => t.userId === user.uid);\n\n          return this.angularFirestore.collection('books').snapshotChanges();\n        }),\n        mergeMap((books) => {\n          const unfilteredBooks = books\n            .map((t) => ({\n              id: t.payload.doc.id,\n              ...t.payload.doc.data() as Book\n            }));\n          this.books = unfilteredBooks.filter(t => this.booksShelves.map(x => x.id).includes(t.bookShelfId));\n\n          return this.angularFirestore.collection('stars').snapshotChanges();\n        })\n      ).subscribe((reviews) => {\n        const unfilteredReviews = reviews\n          .map((t) => ({\n            id: t.payload.doc.id,\n            ...t.payload.doc.data() as Review\n          }));\n        this.reviews = unfilteredReviews.filter(t => this.books.map(x => x.id).includes((t as any).bookId));\n      });\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport {\n  AngularFirestore,\n  AngularFirestoreDocument,\n  AngularFirestoreCollection,\n} from '@angular/fire/firestore';\nimport firebase from 'firebase/app';\n\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nexport interface Users {\n  uid: string;\n  displayName: string;\n}\n\nexport interface Bookshelf {\n  id: string;\n  userId: string;\n  name: string;\n}\n\nexport interface Book {\n  id?: string;\n  authors?: string;\n  cover?: string;\n  isbn?: string;\n  number_of_pages?: string;\n  publish_date?: string;\n  publishers?: string;\n  title?: string;\n  bookShelfId: string;\n  createdAt: Date;\n}\n\nexport interface Stars {\n  booksID: string;\n  userID: string;\n  text: string;\n  rating: number;\n  createdAt: firebase.firestore.FieldValue;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FirestoreService {\n  currentUser: Users = null;\n  currentReview: Stars = null;\n  usersCollection: AngularFirestoreCollection<Users>;\n  users: Observable<Users[]>;\n\n  constructor(\n    public afAuth: AngularFireAuth,\n    public afStore: AngularFirestore\n  ) {\n    this.afAuth.onAuthStateChanged((user) => {\n      this.currentUser = user;\n    });\n  }\n\n  // getBooks() {\n  //   this.afStore\n  //     .collection('books')\n  //     .get()\n  //     .forEach((el) => {\n  //       console.log(el);\n  //     });\n  // }\n\n  // Asta functioneaza, daca tu ai alta modalitate, poti sa o modifici schimbi\n  addBook(book: Book) {\n    return this.afStore.collection('books').add({\n      authors: book.authors,\n      cover: book.cover,\n      isbn: book.isbn,\n      number_of_pages: book.number_of_pages,\n      publish_date: book.publish_date,\n      publishers: book.publishers,\n      title: book.title,\n      bookShelfId: book.bookShelfId,\n      createdAt: book.createdAt\n    });\n  }\n}\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title class=\\\"title-text\\\">Search reviews</ion-title>\\n  </ion-toolbar>\\n  <ion-grid fixed>\\n    <ion-row>\\n      <ion-col\\n        size=\\\"12\\\"\\n        class=\\\"ion-align-items-center ion-justify-content-center\\\"\\n      >\\n        <ion-searchbar\\n          showCancelButton=\\\"never\\\"\\n          placeholder=\\\"Filter by Book Title\\\"\\n          [(ngModel)]=\\\"searchTerm\\\"\\n          animated\\n        ></ion-searchbar>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-grid class=\\\"ion-align-items-center ion-justify-content-center\\\">\\n    <ion-row class=\\\"ion-justify-content-center\\\">\\n      <!-- tot ce e in ion-col e template-ul pentru afisarea recenziilor -->\\n      <ion-col\\n        size=\\\"12\\\"\\n        size-md=\\\"6\\\"\\n        size-lg=\\\"4\\\"\\n        style=\\\"width: 390px\\\"\\n        *ngFor=\\\"let review of reviews| filter: searchTerm\\\"\\n      >\\n        <ion-card>\\n          <ion-card-header>\\n            <ion-item lines=\\\"none\\\">\\n              <ion-label class=\\\"card-title ion-text-wrap\\\"\\n                >{{review.title}}</ion-label\\n              >\\n            </ion-item>\\n            <ion-card-subtitle>{{review.bookAuthors}}</ion-card-subtitle>\\n          </ion-card-header>\\n          <ion-card-content\\n            class=\\\"\\n              ion-text-center ion-justify-content-between ion-align-items-center\\n            \\\"\\n          >\\n            <div\\n              style=\\\"width: 100px; height: 250px\\\"\\n              class=\\\"ion-float-left ion-align-items-center\\\"\\n            >\\n              <ion-img\\n                class=\\\"ion-align-items-center\\\"\\n                src=\\\"{{review.cover}}\\\"\\n                style=\\\"\\n                  width: 100px;\\n                  height: 250px;\\n                  margin-bottom: 20%;\\n                  display: inline-block;\\n                \\\"\\n              ></ion-img>\\n            </div>\\n            <ion-list lines=\\\"none\\\">\\n              <ion-item class=\\\"review-text\\\"> {{review.text}} </ion-item>\\n              <ion-item>\\n                <ion-label> {{review.rating}}</ion-label>\\n              </ion-item>\\n            </ion-list>\\n          </ion-card-content>\\n        </ion-card>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\\n\";"],"names":[],"sourceRoot":"webpack:///"}